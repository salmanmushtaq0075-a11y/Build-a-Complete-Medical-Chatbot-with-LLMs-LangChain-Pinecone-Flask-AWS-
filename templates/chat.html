<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Shifa AI — AI Medical Assistant</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Secure AI-powered medical assistant for symptom checking and health advice" />

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Merriweather:wght@300;400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <style>
    :root {
      /* Enterprise Medical Palette */
      --primary: #0056b3; /* Trustworthy Deep Blue */
      --primary-light: #e6f0ff;
      --primary-dark: #004494;
      --accent: #00a8cc; /* Calming Teal */
      --accent-light: #e0f7fa;
      
      --bg-body: #f4f7f6;
      --bg-white: #ffffff;
      --bg-input: #fafbfc;
      
      --text-dark: #2c3e50;
      --text-muted: #6c757d;
      --text-light: #95a5a6;
      
      --border: #e9ecef;
      --border-light: #f1f3f5;
      --shadow: 0 2px 15px rgba(0,0,0,0.04);
      --shadow-lg: 0 4px 25px rgba(0,0,0,0.08);
      
      /* Chat Colors */
      --bot-bg: #ffffff;
      --bot-border: #e9ecef;
      --user-bg: #0056b3;
      --user-text: #ffffff;
      
      --success: #27ae60;
      --success-bg: #eafaf1;
      --warning: #f39c12;
      --error: #e74c3c;
    }

    [data-theme="dark"] {
      --primary: #4a9eff;
      --primary-light: #1a3a5c;
      --primary-dark: #2d5aa0;
      --accent: #00d4ff;
      --accent-light: #0a2e3d;
      
      --bg-body: #0d1117;
      --bg-white: #161b22;
      --bg-input: #1c2128;
      
      --text-dark: #e6edf3;
      --text-muted: #8b949e;
      --text-light: #6e7681;
      
      --border: #30363d;
      --border-light: #21262d;
      --shadow: 0 2px 15px rgba(0,0,0,0.3);
      --shadow-lg: 0 4px 25px rgba(0,0,0,0.5);
      
      --bot-bg: #161b22;
      --bot-border: #30363d;
      --user-bg: #4a9eff;
      --user-text: #ffffff;
      
      --success: #3fb950;
      --success-bg: #1a472a;
      --warning: #d29922;
      --error: #f85149;
    }

    * { 
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      margin: 0;
      font-family: 'Inter', sans-serif;
      background-color: var(--bg-body);
      color: var(--text-dark);
      height: 100vh;
      display: flex;
      flex-direction: column;
      transition: background-color 0.3s ease, color 0.3s ease;
    }

    /* --- Header (Corporate Branding) --- */
    .navbar {
      background: var(--bg-white);
      border-bottom: 1px solid var(--border);
      padding: 15px 30px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      height: 70px;
      box-shadow: var(--shadow);
      transition: all 0.3s ease;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .company-logo {
      font-size: 1.5rem;
      color: var(--primary);
    }

    .brand-text h3 {
      margin: 0;
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--primary);
      transition: color 0.3s ease;
    }

    .brand-text span {
      font-size: 0.75rem;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .navbar-actions {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .security-badge {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.8rem;
      color: var(--success);
      background: var(--success-bg);
      padding: 6px 12px;
      border-radius: 20px;
      font-weight: 500;
      transition: all 0.3s ease;
    }

    .theme-toggle {
      width: 40px;
      height: 40px;
      border-radius: 8px;
      border: 1px solid var(--border);
      background: var(--bg-white);
      color: var(--text-dark);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1rem;
      transition: all 0.2s ease;
      position: relative;
    }

    .theme-toggle:hover {
      background: var(--primary-light);
      border-color: var(--primary);
      color: var(--primary);
    }

    .theme-toggle i {
      transition: transform 0.3s ease, opacity 0.3s ease;
      position: absolute;
    }

    .theme-toggle .fa-sun {
      opacity: 1;
    }

    .theme-toggle .fa-moon {
      opacity: 0;
    }

    [data-theme="dark"] .theme-toggle .fa-sun {
      opacity: 0;
    }

    [data-theme="dark"] .theme-toggle .fa-moon {
      opacity: 1;
    }

    /* --- Main Layout --- */
    .container {
      flex: 1;
      display: flex;
      max-width: 1400px;
      margin: 0 auto;
      width: 100%;
      padding: 20px;
      gap: 20px;
      height: calc(100vh - 70px);
    }

    /* Sidebar (Helper Info) */
    .sidebar {
      width: 300px;
      background: var(--bg-white);
      border-radius: 12px;
      padding: 25px;
      border: 1px solid var(--border);
      display: flex;
      flex-direction: column;
      gap: 20px;
      display: none; /* Hidden on mobile, shown on desktop */
      transition: all 0.3s ease;
    }

    @media(min-width: 992px) { 
      .sidebar { 
        display: flex; 
      } 
    }

    .doctor-profile {
      text-align: center;
      padding-bottom: 20px;
      border-bottom: 1px solid var(--border);
    }

    .doctor-img-lg {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      object-fit: cover;
      border: 3px solid var(--primary-light);
      margin-bottom: 10px;
      transition: all 0.3s ease;
    }

    .doctor-profile h4 { 
      margin: 5px 0; 
      color: var(--text-dark);
    }
    
    .doctor-profile p { 
      margin: 0; 
      font-size: 0.85rem; 
      color: var(--text-muted);
    }

    .info-box {
      background: var(--primary-light);
      border-radius: 8px;
      padding: 15px;
      font-size: 0.85rem;
      color: var(--primary);
      transition: all 0.3s ease;
    }

    .info-box i {
      margin-right: 6px;
    }

    .info-box strong {
      display: block;
      margin-bottom: 5px;
    }

    /* Sidebar Additional Content */
    .sidebar-content {
      display: flex;
      flex-direction: column;
      gap: 15px;
      flex: 1;
    }

    .health-tips {
      background: var(--accent-light);
      border-radius: 8px;
      padding: 15px;
      border: 1px solid rgba(0,168,204,0.2);
    }

    .health-tips h5 {
      font-size: 0.85rem;
      font-weight: 600;
      color: var(--accent);
      margin: 0 0 10px 0;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .health-tips h5 i {
      font-size: 0.9rem;
    }

    .tip-item {
      font-size: 0.75rem;
      color: var(--text-dark);
      margin-bottom: 8px;
      padding-left: 18px;
      position: relative;
      line-height: 1.4;
    }

    .tip-item:last-child {
      margin-bottom: 0;
    }

    .tip-item::before {
      content: '•';
      position: absolute;
      left: 0;
      color: var(--accent);
      font-weight: bold;
      font-size: 1rem;
    }

    .quick-stats {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }

    .stat-item {
      background: var(--bg-white);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 12px;
      text-align: center;
      transition: all 0.2s ease;
    }

    .stat-item:hover {
      border-color: var(--primary);
      transform: translateY(-2px);
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }

    .stat-number {
      font-size: 1.2rem;
      font-weight: 700;
      color: var(--primary);
      margin-bottom: 4px;
    }

    .stat-label {
      font-size: 0.7rem;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .compliance-footer {
      background: var(--bg-white);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 18px;
      margin-top: auto;
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
      width: 100%;
      box-sizing: border-box;
      overflow: hidden;
    }

    .compliance-header {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 12px;
      padding-bottom: 10px;
      border-bottom: 1px solid var(--border);
    }

    .compliance-header i {
      color: var(--primary);
      font-size: 1rem;
    }

    .compliance-header h5 {
      font-size: 0.85rem;
      font-weight: 600;
      color: var(--text-dark);
      margin: 0;
    }

    .compliance-content {
      font-size: 0.7rem;
      color: var(--text-muted);
      line-height: 1.6;
      margin-bottom: 12px;
    }

    .compliance-content p {
      margin: 0 0 8px 0;
    }

    .compliance-content p:last-child {
      margin-bottom: 0;
    }

    .compliance-badges {
      display: flex;
      flex-wrap: nowrap;
      gap: 6px;
      margin-top: 12px;
      padding-top: 12px;
      border-top: 1px solid var(--border);
      justify-content: space-between;
    }

    .compliance-badge {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 4px;
      background: var(--primary-light);
      color: var(--primary);
      padding: 6px 6px;
      border-radius: 6px;
      font-size: 0.6rem;
      font-weight: 600;
      border: 1px solid rgba(0,86,179,0.2);
      flex: 1;
      min-width: 0;
      white-space: nowrap;
      text-align: center;
    }

    .compliance-badge span {
      display: inline-block;
      max-width: 100%;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .compliance-badge i {
      font-size: 0.7rem;
    }

    .compliance-version {
      text-align: center;
      font-size: 0.65rem;
      color: var(--text-light);
      margin-top: 10px;
      padding-top: 10px;
      border-top: 1px solid var(--border);
    }

    .compliance-footer strong {
      color: var(--text-muted);
      display: block;
      margin-bottom: 5px;
    }

    /* --- UPDATED: Chat Actions Bar --- */
    .chat-actions {
      display: flex;
      gap: 8px;
      padding: 12px 30px;
      background: var(--bg-input);
      border-bottom: 1px solid var(--border);
      /* Use space-between to push Status to left and Buttons to right */
      justify-content: space-between;
      align-items: center;
    }

    /* New Status Styles */
    .chat-status {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.85rem;
      font-weight: 500;
      color: var(--text-muted);
      font-family: 'Inter', sans-serif;
    }

    .status-dot-pulse {
      width: 8px;
      height: 8px;
      background-color: var(--success);
      border-radius: 50%;
      box-shadow: 0 0 0 0 rgba(39, 174, 96, 0.7);
      animation: pulse-green 2s infinite;
    }

    @keyframes pulse-green {
      0% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(39, 174, 96, 0.7); }
      70% { transform: scale(1); box-shadow: 0 0 0 6px rgba(39, 174, 96, 0); }
      100% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(39, 174, 96, 0); }
    }

    /* Group for buttons to keep them together on the right */
    .chat-actions-buttons {
      display: flex;
      gap: 8px;
    }

    .chat-action-btn {
      padding: 6px 12px;
      border-radius: 6px;
      border: 1px solid var(--border);
      background: var(--bg-white);
      color: var(--text-dark);
      cursor: pointer;
      font-size: 0.8rem;
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 6px;
      transition: all 0.2s ease;
      font-family: 'Inter', sans-serif;
    }

    .chat-action-btn:hover {
      background: var(--primary-light);
      border-color: var(--primary);
      color: var(--primary);
    }

    .chat-action-btn i {
      font-size: 0.75rem;
    }

    /* Chat Area */
    .chat-wrapper {
      flex: 1;
      background: var(--bg-white);
      border-radius: 12px;
      border: 1px solid var(--border);
      display: flex;
      flex-direction: column;
      overflow: hidden;
      box-shadow: var(--shadow);
      transition: all 0.3s ease;
    }

    .chat-messages {
      flex: 1;
      padding: 30px;
      overflow-y: auto;
      background: var(--bg-white);
      display: flex;
      flex-direction: column;
      gap: 25px;
      scroll-behavior: smooth;
      transition: background-color 0.3s ease;
    }

    .chat-messages::-webkit-scrollbar {
      width: 6px;
    }

    .chat-messages::-webkit-scrollbar-track {
      background: var(--bg-body);
    }

    .chat-messages::-webkit-scrollbar-thumb {
      background: var(--border);
      border-radius: 3px;
    }

    .chat-messages::-webkit-scrollbar-thumb:hover {
      background: var(--text-light);
    }

    /* Message Bubbles */
    .message {
      display: flex;
      gap: 15px;
      max-width: 85%;
      animation: fadeIn 0.3s ease;
      position: relative;
    }

    @keyframes fadeIn { 
      from { 
        opacity: 0; 
        transform: translateY(5px); 
      } 
      to { 
        opacity: 1; 
        transform: translateY(0); 
      } 
    }

    .message.user {
      align-self: flex-end;
      flex-direction: row-reverse;
    }

    .avatar {
      width: 45px;
      height: 45px;
      border-radius: 50%;
      object-fit: cover;
      flex-shrink: 0;
      border: 1px solid var(--border);
      transition: all 0.3s ease;
    }

    .message.user .avatar {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      border-color: var(--primary);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1.1rem;
    }

    .bubble-container {
      display: flex;
      flex-direction: column;
      position: relative;
      flex: 1;
    }

    .message-actions {
      position: absolute;
      top: -8px;
      right: 0;
      display: flex;
      gap: 4px;
      opacity: 0;
      transition: opacity 0.2s ease;
      z-index: 10;
    }

    .message:hover .message-actions {
      opacity: 1;
    }

    .message-action-btn {
      width: 28px;
      height: 28px;
      border-radius: 6px;
      border: 1px solid var(--border);
      background: var(--bg-white);
      color: var(--text-muted);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.75rem;
      transition: all 0.2s ease;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }

    .message-action-btn:hover {
      background: var(--primary);
      color: white;
      border-color: var(--primary);
      transform: scale(1.1);
    }

    .sender-name {
      font-size: 0.75rem;
      color: var(--text-muted);
      margin-bottom: 4px;
      margin-left: 10px;
    }
    
    .message.user .sender-name { 
      text-align: right; 
      margin-right: 10px; 
    }

    .message-time {
      font-size: 0.7rem;
      color: var(--text-light);
      margin-top: 4px;
      margin-left: 10px;
    }

    .message.user .message-time {
      text-align: right;
      margin-right: 10px;
    }

    .bubble {
      padding: 15px 20px;
      border-radius: 18px;
      font-size: 0.95rem;
      line-height: 1.6;
      font-family: 'Merriweather', serif;
      word-wrap: break-word;
      transition: all 0.3s ease;
    }

    .bot .bubble {
      background: var(--bot-bg);
      color: var(--text-dark);
      border: 1px solid var(--bot-border);
      border-top-left-radius: 4px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.02);
    }

    .user .bubble {
      background: var(--user-bg);
      color: var(--user-text);
      border-top-right-radius: 4px;
      box-shadow: 0 2px 5px rgba(0,86,179,0.2);
    }

    /* Message Reactions */
    .message-reactions {
      display: flex;
      gap: 6px;
      margin-top: 8px;
      margin-left: 10px;
      opacity: 0;
      transition: opacity 0.2s ease;
    }

    .message.bot:hover .message-reactions {
      opacity: 1;
    }

    .reaction-btn {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      border: 1px solid var(--border);
      background: var(--bg-white);
      color: var(--text-muted);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8rem;
      transition: all 0.2s ease;
    }

    .reaction-btn:hover {
      background: var(--primary-light);
      border-color: var(--primary);
      color: var(--primary);
      transform: scale(1.1);
    }

    .reaction-btn.active {
      background: var(--primary);
      border-color: var(--primary);
      color: white;
    }

    /* Suggested Follow-ups */
    .suggested-questions {
      margin-top: 12px;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .suggested-question {
      padding: 8px 14px;
      background: var(--primary-light);
      border: 1px solid var(--border);
      border-radius: 12px;
      color: var(--primary);
      font-size: 0.8rem;
      cursor: pointer;
      transition: all 0.2s ease;
      font-family: 'Inter', sans-serif;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .suggested-question:hover {
      background: var(--primary);
      color: white;
      transform: translateX(3px);
    }

    .suggested-question i {
      font-size: 0.7rem;
    }

    /* Quick Questions */
    .quick-questions {
      padding: 15px 30px;
      background: var(--bg-input);
      border-top: 1px solid var(--border);
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      max-height: 150px;
      overflow-y: auto;
      transition: all 0.3s ease;
    }

    .quick-questions.hidden {
      display: none;
    }

    .quick-question-chip {
      background: var(--bg-white);
      border: 1.5px solid var(--border);
      color: var(--text-dark);
      padding: 10px 18px;
      border-radius: 25px;
      font-size: 0.85rem;
      cursor: pointer;
      transition: all 0.2s ease;
      font-family: 'Inter', sans-serif;
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 8px;
      white-space: nowrap;
    }

    .quick-question-chip:hover {
      background: var(--primary);
      color: white;
      border-color: var(--primary);
      transform: translateY(-2px);
      box-shadow: 0 2px 8px rgba(0,86,179,0.2);
    }

    .quick-question-chip i {
      font-size: 0.75rem;
    }

    /* Input Area */
    .input-area {
      padding: 20px 30px;
      background: var(--bg-input);
      border-top: 1px solid var(--border);
      transition: all 0.3s ease;
    }

    .input-group {
      position: relative;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .voice-btn {
      width: 42px;
      height: 42px;
      border-radius: 50%;
      border: 1px solid var(--border);
      background: var(--bg-white);
      color: var(--text-dark);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1rem;
      transition: all 0.2s ease;
    }

    .voice-btn:hover {
      background: var(--primary-light);
      border-color: var(--primary);
      color: var(--primary);
    }

    .voice-btn.recording {
      background: var(--error);
      border-color: var(--error);
      color: white;
      animation: pulse 1.5s infinite;
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    .chat-input {
      flex: 1;
      padding: 16px 50px 16px 20px;
      border: 1px solid var(--border);
      border-radius: 30px;
      font-size: 1rem;
      outline: none;
      transition: all 0.2s;
      background: var(--bg-white);
      font-family: 'Inter', sans-serif;
      color: var(--text-dark);
    }

    .chat-input:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(0,86,179,0.1);
    }

    .send-btn {
      position: absolute;
      right: 8px;
      width: 42px;
      height: 42px;
      border-radius: 50%;
      background: var(--primary);
      color: white;
      border: none;
      cursor: pointer;
      display: grid;
      place-items: center;
      transition: transform 0.2s;
    }

    .send-btn:hover { 
      transform: scale(1.05); 
    }

    .send-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    /* Typing Animation */
    .typing { 
      display: flex; 
      gap: 4px; 
      padding: 10px; 
    }
    
    .dot { 
      width: 6px; 
      height: 6px; 
      background: #ccc; 
      border-radius: 50%; 
      animation: bounce 1.4s infinite; 
    }
    
    .dot:nth-child(2) { animation-delay: 0.2s; }
    .dot:nth-child(3) { animation-delay: 0.4s; }
    
    @keyframes bounce { 
      0%, 100% { 
        transform: translateY(0); 
      } 
      50% { 
        transform: translateY(-5px); 
      } 
    }

    /* Toast Notification */
    .toast {
      position: fixed;
      bottom: 30px;
      right: 30px;
      background: var(--bg-white);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 12px 18px;
      box-shadow: var(--shadow-lg);
      display: flex;
      align-items: center;
      gap: 10px;
      z-index: 1000;
      animation: slideInRight 0.3s ease;
      max-width: 300px;
    }

    @keyframes slideInRight {
      from {
        transform: translateX(400px);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    .toast i {
      color: var(--success);
      font-size: 1rem;
    }

    .toast.hidden {
      display: none;
    }

    /* Mobile Responsive */
    @media (max-width: 991px) {
      .navbar {
        padding: 12px 20px;
      }

      .brand-text h3 {
        font-size: 1rem;
      }

      .security-badge {
        font-size: 0.75rem;
        padding: 5px 10px;
      }

      .theme-toggle {
        width: 36px;
        height: 36px;
        font-size: 0.9rem;
      }

      .container {
        padding: 10px;
        gap: 10px;
      }

      .chat-actions {
        padding: 10px 15px;
      }

      .chat-action-btn {
        padding: 5px 10px;
        font-size: 0.75rem;
      }

      .chat-messages {
        padding: 20px 15px;
        gap: 20px;
      }

      .message {
        max-width: 90%;
      }

      .quick-questions {
        padding: 12px 15px;
        max-height: 120px;
        gap: 8px;
      }

      .quick-question-chip {
        font-size: 0.8rem;
        padding: 8px 14px;
      }

      .input-area {
        padding: 15px;
      }

      .voice-btn {
        width: 38px;
        height: 38px;
        font-size: 0.9rem;
      }

      .chat-input {
        padding: 14px 48px 14px 18px;
        font-size: 0.95rem;
      }

      .send-btn {
        width: 38px;
        height: 38px;
        right: 6px;
      }

      .toast {
        bottom: 20px;
        right: 20px;
        left: 20px;
        max-width: none;
      }
    }
  </style>
</head>
<body data-theme="light">

  <nav class="navbar">
    <div class="brand">
      <div class="company-logo"><i class="fa-solid fa-hospital-user"></i></div>
      <div class="brand-text">
        <h3>Shifa AI</h3>
        <span>AI Medical Assistant</span>
      </div>
    </div>
    <div class="navbar-actions">
      <div class="security-badge">
        <i class="fa-solid fa-lock"></i> Secure & Encrypted
      </div>
      <button class="theme-toggle" id="themeToggle" aria-label="Toggle dark mode">
        <i class="fa-solid fa-sun"></i>
        <i class="fa-solid fa-moon"></i>
      </button>
    </div>
  </nav>

  <div class="container">
    
    <aside class="sidebar">
      <div class="doctor-profile">
        <img src="https://cdn-icons-png.flaticon.com/512/3304/3304567.png" alt="Dr. Sarah" class="doctor-img-lg">
        <h4>Dr. Sarah (AI)</h4>
        <p>Internal Medicine Specialist</p>
      </div>

      <div class="info-box">
        <i class="fa-solid fa-circle-info"></i>
        <strong>How I can help:</strong>
        <p style="margin-top:5px; margin-bottom:0;">I can answer questions about symptoms, medications, and general wellness based on verified medical texts.</p>
      </div>

      <div class="sidebar-content">
        <div class="health-tips">
          <h5>
            <i class="fa-solid fa-lightbulb"></i>
            Health Tips
          </h5>
          <div class="tip-item">Stay hydrated - drink 8 glasses of water daily</div>
          <div class="tip-item">Get 7-9 hours of quality sleep each night</div>
          <div class="tip-item">Exercise regularly - 30 minutes, 5 days a week</div>
          <div class="tip-item">Eat a balanced diet with fruits and vegetables</div>
        </div>

        <div class="quick-stats">
          <div class="stat-item">
            <div class="stat-number">24/7</div>
            <div class="stat-label">Available</div>
          </div>
          <div class="stat-item">
            <div class="stat-number">100%</div>
            <div class="stat-label">Secure</div>
          </div>
        </div>

      </div>

      <div class="compliance-footer">
        <div class="compliance-header">
          <i class="fa-solid fa-shield-halved"></i>
          <h5>Medical Disclaimer & Compliance</h5>
        </div>
        <div class="compliance-content">
          <p><strong>Important Notice:</strong> This AI assistant is for informational purposes only and does not constitute professional medical diagnosis, treatment, or advice.</p>
          <p>Always consult with qualified healthcare providers for medical concerns, emergencies, or before making any health-related decisions.</p>
          <p>This service is not a substitute for professional medical care.</p>
        </div>
        <div class="compliance-badges">
          <div class="compliance-badge">
            <i class="fa-solid fa-shield-check"></i>
            <span>HIPAA</span>
          </div>
          <div class="compliance-badge">
            <i class="fa-solid fa-certificate"></i>
            <span>ISO 27001</span>
          </div>
          <div class="compliance-badge">
            <i class="fa-solid fa-lock"></i>
            <span>Secure</span>
          </div>
        </div>
        <div class="compliance-version">
          <p>Version 2.4.1 | Last Updated: 2024</p>
        </div>
      </div>
    </aside>

    <div class="chat-wrapper">
      
      <div class="chat-actions">
        <div class="chat-status">
            <div class="status-dot-pulse"></div>
            <span>Assistant is Online</span>
        </div>
        
        <div class="chat-actions-buttons">
            <button class="chat-action-btn" id="clearChatBtn">
              <i class="fa-solid fa-trash-can"></i>
              <span>Clear</span>
            </button>
            <button class="chat-action-btn" id="exportChatBtn">
              <i class="fa-solid fa-download"></i>
              <span>Export</span>
            </button>
        </div>
      </div>

      <div class="chat-messages" id="chatbox">
        
        <div class="message bot">
          <img src="https://cdn-icons-png.flaticon.com/512/3304/3304567.png" class="avatar" alt="Dr. Sarah">
          <div class="bubble-container">
            <span class="sender-name">Dr. Sarah (AI)</span>
            <div class="bubble">
              Hello! I am Dr. Sarah, your virtual medical assistant. I am here to help you understand your health better.<br><br>
              How can I support you today?
            </div>
            <span class="message-time" id="welcome-time"></span>
            <div class="message-reactions">
              <button class="reaction-btn" onclick="handleReaction(this, 'up')" title="Helpful">
                <i class="fa-solid fa-thumbs-up"></i>
              </button>
              <button class="reaction-btn" onclick="handleReaction(this, 'down')" title="Not helpful">
                <i class="fa-solid fa-thumbs-down"></i>
              </button>
            </div>
          </div>
        </div>

      </div>

      <div class="quick-questions" id="quickQuestions">
        <div class="quick-question-chip" data-question="What is acne and how can I treat it?">
          <i class="fa-solid fa-face-smile"></i>
          <span>What is Acne?</span>
        </div>
        <div class="quick-question-chip" data-question="How to treat mild fever at home?">
          <i class="fa-solid fa-temperature-high"></i>
          <span>Treat Mild Fever</span>
        </div>
        <div class="quick-question-chip" data-question="What is a heart healthy diet?">
          <i class="fa-solid fa-heart"></i>
          <span>Heart Healthy Diet</span>
        </div>
        <div class="quick-question-chip" data-question="What are the warning signs of diabetes?">
          <i class="fa-solid fa-circle-exclamation"></i>
          <span>Diabetes Warning Signs</span>
        </div>
        <div class="quick-question-chip" data-question="What are the symptoms of high blood pressure?">
          <i class="fa-solid fa-heartbeat"></i>
          <span>High Blood Pressure</span>
        </div>
        <div class="quick-question-chip" data-question="How to manage stress and anxiety naturally?">
          <i class="fa-solid fa-brain"></i>
          <span>Stress Management</span>
        </div>
        <div class="quick-question-chip" data-question="What are the early signs of a stroke?">
          <i class="fa-solid fa-head-side-virus"></i>
          <span>Stroke Warning Signs</span>
        </div>
        <div class="quick-question-chip" data-question="How to boost immune system naturally?">
          <i class="fa-solid fa-shield-virus"></i>
          <span>Boost Immunity</span>
        </div>
      </div>

      <div class="input-area">
        <form class="input-group" id="messageForm">
          <button type="button" class="voice-btn" id="voiceBtn" title="Voice input">
            <i class="fa-solid fa-microphone"></i>
          </button>
          <input type="text" 
                 class="chat-input" 
                 id="textInput" 
                 placeholder="Type your health concern..." 
                 required 
                 autocomplete="off"
                 autofocus>
          <button type="submit" class="send-btn" id="sendBtn">
            <i class="fa-solid fa-paper-plane"></i>
          </button>
        </form>
      </div>
    </div>
  </div>

  <div class="toast hidden" id="toast">
    <i class="fa-solid fa-check-circle"></i>
    <span id="toastMessage">Message copied to clipboard</span>
  </div>

  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script>
    // Doctor Avatar URL (Easy to change here)
    const botAvatar = "https://cdn-icons-png.flaticon.com/512/3304/3304567.png";
    const userAvatar = "https://cdn-icons-png.flaticon.com/512/1144/1144760.png"; // Anonymous user icon

    // Theme Management
    function initTheme() {
      const savedTheme = localStorage.getItem('theme') || 'light';
      document.documentElement.setAttribute('data-theme', savedTheme);
    }

    function toggleTheme() {
      const currentTheme = document.documentElement.getAttribute('data-theme');
      const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
      document.documentElement.setAttribute('data-theme', newTheme);
      localStorage.setItem('theme', newTheme);
    }

    // Utility Functions
    function scrollToBottom() {
      const chat = document.getElementById('chatbox');
      setTimeout(() => {
        chat.scrollTop = chat.scrollHeight;
      }, 100);
    }

    function formatTime(date = new Date()) {
      return date.toLocaleTimeString('en-US', { 
        hour: 'numeric', 
        minute: '2-digit',
        hour12: true 
      });
    }

    function escapeHtml(text) {
      const map = {
        '&': '&amp;',
        '<': '&lt;',
        '>': '&gt;',
        '"': '&quot;',
        "'" : '&#039;'
      };
      return text.replace(/[&<>"']/g, m => map[m]);
    }

    function formatMessage(text) {
      return escapeHtml(text).replace(/\n/g, '<br>');
    }

    function showToast(message) {
      const toast = document.getElementById('toast');
      const toastMessage = document.getElementById('toastMessage');
      toastMessage.textContent = message;
      toast.classList.remove('hidden');
      
      setTimeout(() => {
        toast.classList.add('hidden');
      }, 3000);
    }

    function copyToClipboard(text) {
      if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(text).then(() => {
          showToast('Message copied to clipboard');
        }).catch(() => {
          showToast('Failed to copy message');
        });
      } else {
        const textArea = document.createElement('textarea');
        textArea.value = text;
        textArea.style.position = 'fixed';
        textArea.style.opacity = '0';
        document.body.appendChild(textArea);
        textArea.select();
        try {
          document.execCommand('copy');
          showToast('Message copied to clipboard');
        } catch (err) {
          showToast('Failed to copy message');
        }
        document.body.removeChild(textArea);
      }
    }

    // Voice Input
    let isRecording = false;
    function toggleVoiceInput() {
      if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
        showToast('Voice input not supported in your browser');
        return;
      }

      const voiceBtn = document.getElementById('voiceBtn');
      
      if (!isRecording) {
        isRecording = true;
        voiceBtn.classList.add('recording');
        showToast('Listening... Click again to stop');
        
        setTimeout(() => {
          if (isRecording) {
            showToast('Voice input feature coming soon');
            isRecording = false;
            voiceBtn.classList.remove('recording');
          }
        }, 2000);
      } else {
        isRecording = false;
        voiceBtn.classList.remove('recording');
        showToast('Recording stopped');
      }
    }

    // Export Chat
    function exportChat() {
      const messages = [];
      $('#chatbox .message').each(function() {
        const isUser = $(this).hasClass('user');
        const text = $(this).find('.bubble').text().trim();
        const time = $(this).find('.message-time').text().trim();
        if (text) {
          messages.push({
            sender: isUser ? 'You' : 'Dr. Sarah (AI)',
            message: text,
            time: time
          });
        }
      });

      if (messages.length === 0) {
        showToast('No messages to export');
        return;
      }

      let exportText = 'Shifa AI - Chat Export\n';
      exportText += 'Generated: ' + new Date().toLocaleString() + '\n';
      exportText += '='.repeat(50) + '\n\n';

      messages.forEach(msg => {
        exportText += `[${msg.time}] ${msg.sender}:\n${msg.message}\n\n`;
      });

      const blob = new Blob([exportText], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `shifa-ai-chat-${Date.now()}.txt`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
      
      showToast('Chat exported successfully');
    }

    // Generate Suggested Questions
    function generateSuggestedQuestions(responseText) {
      const suggestions = [];
      const lowerText = responseText.toLowerCase();
      
      if (lowerText.includes('fever') || lowerText.includes('temperature')) {
        suggestions.push('How long should a fever last?');
        suggestions.push('When should I see a doctor for fever?');
      }
      if (lowerText.includes('pain') || lowerText.includes('ache')) {
        suggestions.push('What are natural pain relief methods?');
        suggestions.push('When is pain a medical emergency?');
      }
      if (lowerText.includes('diet') || lowerText.includes('nutrition')) {
        suggestions.push('What foods should I avoid?');
        suggestions.push('How to plan a balanced meal?');
      }
      if (lowerText.includes('symptom') || lowerText.includes('sign')) {
        suggestions.push('What other symptoms should I watch for?');
        suggestions.push('When should I seek immediate medical help?');
      }
      
      if (suggestions.length === 0) {
        suggestions.push('Can you tell me more about this?');
        suggestions.push('What are the next steps?');
      }

      return suggestions.slice(0, 3);
    }

    function addUserMessage(text) {
      const time = formatTime();
      const userHtml = `
        <div class="message user">
          <div class="avatar">
            <i class="fa-solid fa-user"></i>
          </div>
          <div class="bubble-container">
            <div class="message-actions">
              <button class="message-action-btn" onclick="copyToClipboard('${escapeHtml(text)}')" title="Copy message">
                <i class="fa-solid fa-copy"></i>
              </button>
            </div>
            <div class="bubble">${formatMessage(text)}</div>
            <span class="message-time">${time}</span>
          </div>
        </div>`;
      
      $("#chatbox").append(userHtml);
      scrollToBottom();
    }

    function addBotMessage(text, messageId = null) {
      const time = formatTime();
      const suggestions = generateSuggestedQuestions(text);
      const suggestionsHtml = suggestions.map(s => 
        `<div class="suggested-question" data-question="${escapeHtml(s)}">
          <i class="fa-solid fa-arrow-right"></i>
          <span>${escapeHtml(s)}</span>
        </div>`
      ).join('');
      
      const botHtml = `
        <div class="message bot" ${messageId ? `id="${messageId}"` : ''}>
          <img src="${botAvatar}" class="avatar" alt="Dr. Sarah">
          <div class="bubble-container">
            <span class="sender-name">Dr. Sarah (AI)</span>
            <div class="message-actions">
              <button class="message-action-btn" onclick="copyToClipboard('${escapeHtml(text)}')" title="Copy message">
                <i class="fa-solid fa-copy"></i>
              </button>
            </div>
            <div class="bubble">${formatMessage(text)}</div>
            <span class="message-time">${time}</span>
            <div class="message-reactions">
              <button class="reaction-btn" onclick="handleReaction(this, 'up')" title="Helpful">
                <i class="fa-solid fa-thumbs-up"></i>
              </button>
              <button class="reaction-btn" onclick="handleReaction(this, 'down')" title="Not helpful">
                <i class="fa-solid fa-thumbs-down"></i>
              </button>
            </div>
            ${suggestionsHtml ? `<div class="suggested-questions">${suggestionsHtml}</div>` : ''}
          </div>
        </div>`;
      
      $("#chatbox").append(botHtml);
      
      $(`#${messageId || ''}`).find('.suggested-question').on('click', function() {
        const question = $(this).data('question');
        if (question) {
          sendMessage(question);
        }
      });
      
      scrollToBottom();
    }

    function handleReaction(btn, type) {
      $(btn).toggleClass('active');
      showToast(`Thank you for your feedback!`);
    }

    function showTypingIndicator() {
      const loadingId = "loading-" + Date.now();
      const loadingHtml = `
        <div class="message bot" id="${loadingId}">
          <img src="${botAvatar}" class="avatar" alt="Dr. Sarah">
          <div class="bubble-container">
            <span class="sender-name">Dr. Sarah (AI)</span>
            <div class="bubble">
              <div class="typing"><div class="dot"></div><div class="dot"></div><div class="dot"></div></div>
            </div>
          </div>
        </div>`;
      
      $("#chatbox").append(loadingHtml);
      scrollToBottom();
      return loadingId;
    }

    function hideQuickQuestions() {
      $("#quickQuestions").addClass("hidden");
    }

    function clearChat() {
      if (confirm('Are you sure you want to clear the chat history?')) {
        const welcomeMessage = `
          <div class="message bot">
            <img src="${botAvatar}" class="avatar" alt="Dr. Sarah">
            <div class="bubble-container">
              <span class="sender-name">Dr. Sarah (AI)</span>
              <div class="bubble">
                Hello! I am Dr. Sarah, your virtual medical assistant. I am here to help you understand your health better.<br><br>
                How can I support you today?
              </div>
              <span class="message-time">${formatTime()}</span>
              <div class="message-reactions">
                <button class="reaction-btn" onclick="handleReaction(this, 'up')" title="Helpful">
                  <i class="fa-solid fa-thumbs-up"></i>
                </button>
                <button class="reaction-btn" onclick="handleReaction(this, 'down')" title="Not helpful">
                  <i class="fa-solid fa-thumbs-down"></i>
                </button>
              </div>
            </div>
          </div>`;
        
        $("#chatbox").html(welcomeMessage);
        $("#quickQuestions").removeClass("hidden");
        scrollToBottom();
        showToast('Chat cleared');
      }
    }

    function sendMessage(messageText) {
      if (!messageText || !messageText.trim()) return;

      const rawText = messageText.trim();
      
      if (!$("#quickQuestions").hasClass("hidden")) {
        hideQuickQuestions();
      }

      addUserMessage(rawText);
      $("#textInput").val("");
      $("#sendBtn").prop("disabled", true);
      
      const loadingId = showTypingIndicator();

      $.ajax({
        data: { msg: rawText },
        type: "POST",
        url: "/get",
        timeout: 30000
      })
      .done(function(data) {
        $(`#${loadingId}`).remove();
        
        if (data && data.trim()) {
          const messageId = "msg-" + Date.now();
          addBotMessage(data, messageId);
        } else {
          addBotMessage("I apologize, but I'm having trouble processing that request. Could you please rephrase your question?");
        }
      })
      .fail(function(xhr, status, error) {
        $(`#${loadingId}`).remove();
        
        let errorMessage = "I'm experiencing technical difficulties. Please try again in a moment.";
        if (status === "timeout") {
          errorMessage = "The request is taking longer than expected. Please try again with a shorter question.";
        }
        
        addBotMessage(errorMessage);
        console.error("AJAX Error:", status, error);
      })
      .always(function() {
        $("#sendBtn").prop("disabled", false);
        $("#textInput").focus();
      });
    }

    // Event Handlers
    $(document).ready(function() {
      // Initialize theme
      initTheme();
      document.getElementById('welcome-time').textContent = formatTime();

      // Theme toggle
      $("#themeToggle").on("click", toggleTheme);

      // Clear chat
      $("#clearChatBtn").on("click", clearChat);

      // Export chat
      $("#exportChatBtn").on("click", exportChat);

      // Voice input
      $("#voiceBtn").on("click", toggleVoiceInput);

      // Form submission
      $("#messageForm").on("submit", function(event) {
        event.preventDefault();
        const messageText = $("#textInput").val().trim();
        if (messageText) {
          sendMessage(messageText);
        }
      });

      // Enter key handling
      $("#textInput").on("keydown", function(e) {
        if (e.key === "Enter" && !e.shiftKey) {
          e.preventDefault();
          $("#messageForm").submit();
        }
      });

      // Quick question chips
      $(".quick-question-chip").on("click", function() {
        const question = $(this).data("question");
        if (question) {
          sendMessage(question);
        }
      });

      scrollToBottom();
      $("#textInput").focus();
    });
  </script>
</body>
</html>